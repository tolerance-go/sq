# HTTP1.1 版本特性

1. 默认持久连接节省通信量，只要客户端服务端任意一端没有明确提出断开 TCP 连接，就一直保持连接，可以发送多次 HTTP 请求

   持久连接使客户端到服务器端连接持续有效，避免了重新建立连接

   大大减少了连接的建立以及关闭时延。HTTP 连接是建立在 TCP 协议之上的，建立一条 TCP 连接需要三次握手，TCP 连接关闭时需要四次挥手。这些都是需要时间的

2. 管线化，客户端可以同时发出多个 HTTP 请求，而不用一个个等待响应

3. 断点续传

实际上就是利用 HTTP 消息头使用分块传输编码，将实体主体分块传输。

## 管线化是什么

管线化机制须通过永久连接（persistent connection）完成，仅 HTTP/1.1 支持此技术（HTTP/1.0 不支持）

在使用持久连接的情况下，某个连接消息的传递类似于

请求 1 -> 响应 1 -> 请求 2 -> 响应 2

管线化：某个连接上的消息变成了类似这样

请求 1 -> 请求 2 -> 请求 3 -> 响应 1 -> 响应 2 -> 响应 3

## 管线化的限制

1. 那么持久连接和管线化的区别在于：

   持久连接的一个缺点是请求和响应式是顺序执行的，只有在请求 1 的响应收到之后，才会发送请求 2，而管线化不需要等待上一次请求得到响应就可以进行下一次请求。实现并行发送请求。

2. 只有 GET 和 HEAD 要求可以进行管线化，而 POST 则有所限制

3. 初次创建连接时也不应启动管线机制，因为对方（服务器）不一定支持 HTTP/1.1 版本的协议。

4. HTTP1.1 要求服务器端支持管线化，但并不要求服务器端也对响应进行管线化处理，只是要求对于管线化的请求不失败，而且现在很多服务器端和代理程序对管线化的支持并不好，现代浏览器 Chrome 和 Firefox 默认并未开启管线化支持。

## 参考资源

- [Http 面试题集合](https://www.jianshu.com/p/7b91778158da)
- [Http 的持久连接和管线化](https://www.cnblogs.com/hyzm/p/9530392.html)
